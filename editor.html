<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Esther's Personal Pet</title>
<link rel="manifest" href="manifest-editor.json">
<link rel="stylesheet" href="styles.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400..700&family=Rubik:ital,wght@0,300..900;1,300..900&family=Viaoda+Libre&display=swap" rel="stylesheet">
</head>
<body>
<div class="scale-wrapper">
  <div class="container">
    <h1>Esther's Personal Pet</h1>
    <h2>Add a Nice Message!</h2>
    <input id="messageInput" type="text"/>
    <button class="save-button" id="saveMessageButton">Save</button>  
    <h3 class="message-request"></h3>
  </div>
</div>

<script>
async function saveMessage(message) {
  await fetch('https://esther-s-personal-panda.vercel.app/api/put_message', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ dailyMessage: message })
  });
}

// Add this event listener
document.getElementById('saveMessageButton').addEventListener('click', async () => {
  const message = document.getElementById('messageInput').value;
  
  if (!message) {
    alert('Please enter a message!');
    return;
  }
  
  try {
    await saveMessage(message);
    alert('Message saved successfully!');
    document.getElementById('messageInput').value = ''; // Clear input
  } catch (error) {
    console.error('Error saving message:', error);
    alert('Failed to save message. Please try again.');
  }
});


let trackerValue = ""; 

async function loadTracker() {
  try {
    const response = await fetch('https://esther-s-personal-panda.vercel.app/api/get_tracker');
    const data = await response.json();
    trackerValue = data.trackerValue; 
    console.log('Loaded message:', trackerValue);
  } catch (error) {
    console.error('Failed to load message:', error);
    trackerValue = "Something went wrong!";
  }
}

loadTracker();
console.log(trackerValue);
if (trackerValue) {
    formArea = box.querySelector('.message-request');
    formArea.innerHTML = `<h3>Request message</h3>`;
    return;
}

</script>
</body>
</html>